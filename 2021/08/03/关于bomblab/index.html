<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">

    

    <!-- 渲染优化 -->
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="HandheldFriendly" content="True" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--icon-->

    
        <link rel="shortcut icon" href="/ico.ico">
    
    
        <link rel="icon" type="image/png" sizes="16x16" href="/smallicon.png">
    
    
        <link rel="icon" type="image/png" sizes="32x32" href="/midicon.png">
    
    
        <link rel="apple-touch-icon" sizes="180x180" href="/ico.ico">
    
    
        <link rel="mask-icon" href="/ico.ico">
    


    <!-- meta -->


<title>关于bomblab | 南方真理会</title>


    <meta name="keywords" content="csapp, 汇编">




    <!-- OpenGraph -->
 
    <meta name="description" content="今天看了csapp的第三章，打算做做bomblab。之前在课上，教授其实或多或少都讲过关于bomblab的介绍，我在之前也看过别人的弹幕，据说很难。因此也做好了心理准备。但是没想到这么难。 万事开头难在csapp网站上下载到了提供自学的lab，然后放到我的wsl里。显然，我已经忘记了tar命令的操作了，一番查找。输入: 123456tar -xvf bomb.tarbomb&#x2F;bomb&#x2F;bombbo">
<meta property="og:type" content="article">
<meta property="og:title" content="关于bomblab">
<meta property="og:url" content="http://dh224.github.io/2021/08/03/%E5%85%B3%E4%BA%8Ebomblab/index.html">
<meta property="og:site_name" content="南方真理会">
<meta property="og:description" content="今天看了csapp的第三章，打算做做bomblab。之前在课上，教授其实或多或少都讲过关于bomblab的介绍，我在之前也看过别人的弹幕，据说很难。因此也做好了心理准备。但是没想到这么难。 万事开头难在csapp网站上下载到了提供自学的lab，然后放到我的wsl里。显然，我已经忘记了tar命令的操作了，一番查找。输入: 123456tar -xvf bomb.tarbomb&#x2F;bomb&#x2F;bombbo">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://satt.oss-cn-hangzhou.aliyuncs.com/img/aa.png">
<meta property="article:published_time" content="2021-08-03T12:00:07.000Z">
<meta property="article:modified_time" content="2023-05-09T11:04:03.044Z">
<meta property="article:author" content="dh">
<meta property="article:tag" content="csapp">
<meta property="article:tag" content="汇编">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://satt.oss-cn-hangzhou.aliyuncs.com/img/aa.png">


    
<link rel="stylesheet" href="/style.css">
 

    
    
        <link rel="stylesheet" id="hl-default-theme" href="/css/highlight/default.css" media="none">
        
            <link rel="stylesheet" id="hl-dark-theme" href="/css/highlight/dark.css" media="none">
        
    

    
    

    
    
<link rel="stylesheet" href="/css/style/dark.css">

    
<script src="/js/darkmode.js"></script>



     

    <!-- custom head -->

<meta name="generator" content="Hexo 5.4.0"></head>

    <body>
        <div id="app">
            <header class="header">
    <div class="header__left">
        <a href="/" class="button">
            <span class="logo__text">南方真理会</span>
        </a>
    </div>
    <div class="header__right">
        
            <div class="navbar__menus">
                
                    <a href="/" class="navbar-menu button">首页</a>
                
                    <a href="/tags/" class="navbar-menu button">标签</a>
                
                    <a href="/archives/" class="navbar-menu button">归档</a>
                
            </div>
        
        
        

        
        
    <a href="javaScript:void(0);" id="btn-toggle-dark">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
    </a>


        

        
            <a class="dropdown-icon button" id="btn-dropdown" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round"><path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path></svg></a>
            <div class="dropdown-menus" id="dropdown-menus">
                
                    <a href="/" class="dropdown-menu button">首页</a>
                
                    <a href="/tags/" class="dropdown-menu button">标签</a>
                
                    <a href="/archives/" class="dropdown-menu button">归档</a>
                
            </div>
        
    </div>
</header>


            <main class="main">
    

<div class="post-title">
    <h1 class="post-title__text">
        关于bomblab
    </h1>
    <div class="post-title__meta">
        <a href="/archives/2021/08/" class="post-meta__date button">2021-08-03</a>
        
 
        
    
    


 

 
    </div>
</div>


    <aside class="post-side">
        <div class="post-side__toc">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%87%E4%BA%8B%E5%BC%80%E5%A4%B4%E9%9A%BE"><span class="toc-text">万事开头难</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bomblab%E7%9A%84%E8%A7%A3%E5%86%B3%E8%BF%87%E7%A8%8B"><span class="toc-text">bomblab的解决过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-1"><span class="toc-text">phase_1()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-2"><span class="toc-text">phase_2()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-3"><span class="toc-text">phase_3()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-4"><span class="toc-text">phase_4()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-5"><span class="toc-text">phase_5()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-6"><span class="toc-text">phase_6()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-text">后记</span></a></li></ol>
        </div>
    </aside>
    <a class="btn-toc button" id="btn-toc" tabindex="0">
        <svg viewBox="0 0 1024 1024" width="32" height="32" xmlns="http://www.w3.org/2000/svg">
            <path d="M128 256h64V192H128zM320 256h576V192H320zM128 544h64v-64H128zM320 544h576v-64H320zM128 832h64v-64H128zM320 832h576v-64H320z" fill="currentColor"></path>
        </svg>
    </a>
    <div class="toc-menus" id="toc-menus">
        <div class="toc-title">Article Directory</div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%87%E4%BA%8B%E5%BC%80%E5%A4%B4%E9%9A%BE"><span class="toc-text">万事开头难</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bomblab%E7%9A%84%E8%A7%A3%E5%86%B3%E8%BF%87%E7%A8%8B"><span class="toc-text">bomblab的解决过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-1"><span class="toc-text">phase_1()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-2"><span class="toc-text">phase_2()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-3"><span class="toc-text">phase_3()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-4"><span class="toc-text">phase_4()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-5"><span class="toc-text">phase_5()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#phase-6"><span class="toc-text">phase_6()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-text">后记</span></a></li></ol>
    </div>


<article class="post post__with-toc content-card">
    <div class="post__header">
    
        <div class="post-thumbnail" style="background-image: url('http://satt.oss-cn-hangzhou.aliyuncs.com/img/aa.png');"></div>
    

    <div class="post__expire" id="post-expired-notify">
        <p>
            This article was last updated on &lt;span id=&#34;expire-date&#34;&gt;&lt;/span&gt; days ago, the information described in the article may be outdated.
        </p>
    </div>
    <script>
        (() => {
            var update = Date.parse("2023-05-09"),
                date = new Date(),
                now = date.getTime(),
                expire = now - update,
                expire_days = Math.floor(expire/(24*3600*1000));
            if (expire_days >= 120) {
                document.querySelectorAll('#expire-date')[0].innerHTML = expire_days;
                document.querySelectorAll('#post-expired-notify')[0].style.display = 'block';
            }
        })();
    </script>
</div>
    <div class="post__content">
        <p>今天看了csapp的第三章，打算做做bomblab。之前在课上，教授其实或多或少都讲过关于bomblab的介绍，我在之前也看过别人的弹幕，据说很难。因此也做好了心理准备。但是没想到这么难。</p>
<h2 id="万事开头难"><a href="#万事开头难" class="headerlink" title="万事开头难"></a>万事开头难</h2><p>在<a target="_blank" rel="noopener" href="http://csapp.cs.cmu.edu/3e/labs.html">csapp网站</a>上下载到了提供自学的lab，然后放到我的wsl里。显然，我已经忘记了tar命令的操作了，一番查找。输入:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf bomb.tar</span><br><span class="line">bomb/</span><br><span class="line">bomb/bomb</span><br><span class="line">bomb/bomb.c</span><br><span class="line">bomb/README</span><br><span class="line"><span class="built_in">cd</span> bomb/</span><br></pre></td></tr></table></figure>

<p>终于进入了实验室,得到了bomb文件夹下的三个文件。<em>hooray!</em> </p>
<p>打开README.</p>
<blockquote>
<p>This is an x86-64 bomb for self-study students.</p>
</blockquote>
<p>在这里我得不到什么帮助，只能打开bomb.c文件，试图找到一点头绪。但是，里面似乎只是一长段奇怪的代码，以及莫名其妙的DR.EVIL的故事。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/***********************************************************</span><br><span class="line"> * Dr. Evil&#x27;s Insidious Bomb, Version 1.1</span><br><span class="line"> * Copyright 2011, Dr. Evil Incorporated. All rights reserved.</span><br><span class="line"> *</span><br><span class="line"> * LICENSE:</span><br><span class="line"> *</span><br><span class="line"> * Dr. Evil Incorporated (the PERPETRATOR) hereby grants you (the</span><br><span class="line"> * VICTIM) explicit permission to use this bomb (the BOMB).  This is a</span><br><span class="line"> * time limited license, which expires on the death of the VICTIM.</span><br><span class="line"> * The PERPETRATOR takes no responsibility for damage, frustration,</span><br><span class="line"> * insanity, bug-eyes, carpal-tunnel syndrome, loss of sleep, or other</span><br><span class="line"> * harm to the VICTIM.  Unless the PERPETRATOR wants to take credit,</span><br><span class="line"> * that is.  The VICTIM may not distribute this bomb source code to</span><br><span class="line"> * any enemies of the PERPETRATOR.  No VICTIM may debug,</span><br><span class="line"> * reverse-engineer, run &quot;strings&quot; on, decompile, decrypt, or use any</span><br><span class="line"> * other technique to gain knowledge of and defuse the BOMB.  BOMB</span><br><span class="line"> * proof clothing may not be worn when handling this program.  The</span><br><span class="line"> * PERPETRATOR will not apologize for the PERPETRATOR&#x27;s poor sense of</span><br><span class="line"> * humor.  This license is null and void where the BOMB is prohibited</span><br><span class="line"> * by law.</span><br><span class="line"> ***********************************************************/</span><br></pre></td></tr></table></figure>

<p>最后只能百度，一番查找过后，才知道原来还有<a target="_blank" rel="noopener" href="http://csapp.cs.cmu.edu/3e/bomblab.pdf">Writeup</a>。在里面，总算得到一点提示。</p>
<blockquote>
<p>You can also run it under a debugger, watch what it does step by step, and use this information to defuse it. This is probably the fastest way of defusing it.</p>
</blockquote>
<p>里面提到了gdb。自然，我去查找了一番gdb的使用方法，至此。终于可以开始解决bomblab了。</p>
<h2 id="bomblab的解决过程"><a href="#bomblab的解决过程" class="headerlink" title="bomblab的解决过程"></a>bomblab的解决过程</h2><p>当然，像我这样的菜鸡，并不具备独自解决问题的能力。只能参考已有的博客。根据博客上的说法，我只需要用gdb的disas命令，反汇编第一阶段的代码就能得到线索，我当然遵从。<em>其实看了眼bomb.c的源代码，里面有很明显的提示，但是我一开始没有意识到.</em></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Hmm...  Six phases must be more secure than one phase! */</span></span><br><span class="line">input = read_line();             <span class="comment">/* Get input                   */</span></span><br><span class="line">phase_1(input);                  <span class="comment">/* Run the phase               */</span></span><br><span class="line">phase_defused();                 <span class="comment">/* Drat!  They figured it out!</span></span><br><span class="line"><span class="comment">      * Let me know how they did it. */</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Phase 1 defused. How about the next one?\n&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>因此，为了解决问题，首先就是要解决phase_1()。</p>
<h3 id="phase-1"><a href="#phase-1" class="headerlink" title="phase_1()"></a>phase_1()</h3><p>在windows terminal中用gdb打开bomb，然后用disas命令反汇编。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gdb bomb //打开bomb</span><br><span class="line">--------------</span><br><span class="line">(gdb) disas phase_1</span><br></pre></td></tr></table></figure>
<p>得到如下的代码:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function phase_1:</span><br><span class="line">   0x0000000000400ee0 &lt;+0&gt;:     sub    $0x8,%rsp</span><br><span class="line">   0x0000000000400ee4 &lt;+4&gt;:     mov    $0x402400,%esi</span><br><span class="line">   0x0000000000400ee9 &lt;+9&gt;:     call   0x401338 &lt;strings_not_equal&gt;</span><br><span class="line">   0x0000000000400eee &lt;+14&gt;:    test   %eax,%eax</span><br><span class="line">   0x0000000000400ef0 &lt;+16&gt;:    je     0x400ef7 &lt;phase_1+23&gt;</span><br><span class="line">   0x0000000000400ef2 &lt;+18&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000400ef7 &lt;+23&gt;:    add    $0x8,%rsp</span><br><span class="line">   0x0000000000400efb &lt;+27&gt;:    ret</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>让我们来分析分析。首先是第0行，我们知道%rsp是保存指向栈顶的指针的寄存器，而对他进行自减，就是为了给栈帧开辟0x8个字节的空间。第1行，将立即数0x402400保存到%esi中，然后调用了一个 <code>&lt;strings_not_equal&gt;</code>的方法 。在第3行，test了%eax的内容，如果相等,则跳转到第6行，即出栈，返回，函数结束;如果不相等，则跳转到 <code>&lt;explode_bomb&gt;</code> ，显然就是炸弹爆炸了。我们知道，%eax是32位系统中的返回值，容易料想到是保存了<code>&lt;strings_not_equal&gt;</code>的返回值。自此，分析结束。<br>%esi中保存的是用于比较的参数，很可能就是要输入的字串.也就是立即数0x402400是字符串的首地址。于是用gdb命令查看.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x 0x402400</span><br><span class="line">0x402400:       0x64726f42</span><br></pre></td></tr></table></figure>
<p>结果比较诡异，应该是输出了字符串首地址的指针地址。显然，我还是不懂gdb。一番查找，得到正确的x命令参数.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x402400</span><br><span class="line">0x402400:       <span class="string">&quot;Border relations with Canada have never been better.&quot;</span></span><br></pre></td></tr></table></figure>
<p>得到了phase_1()的答案。也就是:</p>
<blockquote>
<p>Border relations with Canada have never been better.</p>
</blockquote>
<h3 id="phase-2"><a href="#phase-2" class="headerlink" title="phase_2()"></a>phase_2()</h3><p>接下去是phase_2()。有了之前打下的基础，phase_2()就不会那么没有头绪了。首先，依旧是使用命令<code>disas phase_2</code>。得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400efc &lt;+0&gt;:     push   %rbp</span><br><span class="line">0x0000000000400efd &lt;+1&gt;:     push   %rbx</span><br><span class="line">0x0000000000400efe &lt;+2&gt;:     sub    $0x28,%rsp</span><br><span class="line">0x0000000000400f02 &lt;+6&gt;:     mov    %rsp,%rsi</span><br><span class="line">0x0000000000400f05 &lt;+9&gt;:     call   0x40145c &lt;read_six_numbers&gt;</span><br><span class="line">0x0000000000400f0a &lt;+14&gt;:    cmpl   $0x1,(%rsp)</span><br><span class="line">0x0000000000400f0e &lt;+18&gt;:    je     0x400f30 &lt;phase_2+52&gt;</span><br><span class="line">0x0000000000400f10 &lt;+20&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400f15 &lt;+25&gt;:    jmp    0x400f30 &lt;phase_2+52&gt;</span><br><span class="line">0x0000000000400f17 &lt;+27&gt;:    mov    -0x4(%rbx),%eax</span><br><span class="line">0x0000000000400f1a &lt;+30&gt;:    add    %eax,%eax</span><br><span class="line">0x0000000000400f1c &lt;+32&gt;:    cmp    %eax,(%rbx)</span><br><span class="line">0x0000000000400f1e &lt;+34&gt;:    je     0x400f25 &lt;phase_2+41&gt;</span><br><span class="line">0x0000000000400f20 &lt;+36&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400f25 &lt;+41&gt;:    add    $0x4,%rbx</span><br><span class="line">0x0000000000400f29 &lt;+45&gt;:    cmp    %rbp,%rbx</span><br><span class="line">0x0000000000400f2c &lt;+48&gt;:    jne    0x400f17 &lt;phase_2+27&gt;</span><br><span class="line">0x0000000000400f2e &lt;+50&gt;:    jmp    0x400f3c &lt;phase_2+64&gt;</span><br><span class="line">0x0000000000400f30 &lt;+52&gt;:    lea    0x4(%rsp),%rbx</span><br><span class="line">0x0000000000400f35 &lt;+57&gt;:    lea    0x18(%rsp),%rbp</span><br><span class="line">0x0000000000400f3a &lt;+62&gt;:    jmp    0x400f17 &lt;phase_2+27&gt;</span><br><span class="line">0x0000000000400f3c &lt;+64&gt;:    add    $0x28,%rsp</span><br><span class="line">0x0000000000400f40 &lt;+68&gt;:    pop    %rbx</span><br><span class="line">0x0000000000400f41 &lt;+69&gt;:    pop    %rbp</span><br><span class="line">0x0000000000400f42 &lt;+70&gt;:    ret</span><br></pre></td></tr></table></figure>

<p>这段显然比phase_1要长一些，但是分析的流程不会变.<br>首先是 <code>push   %rbp</code> 和 <code>push   %rbx</code>。这两个命令我不是很懂，大约就是压入了两个寄存器。后来一番查找，得到结论：</p>
<blockquote>
<p>push   %esi       //将程序的入口地址压入栈中<br>   push   %ebx        //将被调用者保存寄存器中的值压入栈中，以便在返回前可以恢复它们</p>
</blockquote>
<p>总之，这两句对我们分析没有什么关联，继续看。<code>sub    $0x28,%rsp</code>栈指针分配了0x28即40<sub>d</sub>。然后就是将栈指针赋给%rsi。查书p120。可知%rsi用于函数的第二个参数.随后调用了<code>&lt;read_six_numbers&gt;</code>方法。让我们来看看这个方法。和phase_2类似，输入:<code>disas read_six_numbers</code>，得到如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">0x000000000040145c &lt;+0&gt;:     sub    $0x18,%rsp</span><br><span class="line">0x0000000000401460 &lt;+4&gt;:     mov    %rsi,%rdx</span><br><span class="line">0x0000000000401463 &lt;+7&gt;:     lea    0x4(%rsi),%rcx</span><br><span class="line">0x0000000000401467 &lt;+11&gt;:    lea    0x14(%rsi),%rax</span><br><span class="line">0x000000000040146b &lt;+15&gt;:    mov    %rax,0x8(%rsp)</span><br><span class="line">0x0000000000401470 &lt;+20&gt;:    lea    0x10(%rsi),%rax</span><br><span class="line">0x0000000000401474 &lt;+24&gt;:    mov    %rax,(%rsp)</span><br><span class="line">0x0000000000401478 &lt;+28&gt;:    lea    0xc(%rsi),%r9</span><br><span class="line">0x000000000040147c &lt;+32&gt;:    lea    0x8(%rsi),%r8</span><br><span class="line">0x0000000000401480 &lt;+36&gt;:    mov    $0x4025c3,%esi</span><br><span class="line">0x0000000000401485 &lt;+41&gt;:    mov    $0x0,%eax</span><br><span class="line">0x000000000040148a &lt;+46&gt;:    call   0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x000000000040148f &lt;+51&gt;:    cmp    $0x5,%eax</span><br><span class="line">0x0000000000401492 &lt;+54&gt;:    jg     0x401499 &lt;read_six_numbers+61&gt;</span><br><span class="line">0x0000000000401494 &lt;+56&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000401499 &lt;+61&gt;:    add    $0x18,%rsp</span><br><span class="line">0x000000000040149d &lt;+65&gt;:    ret</span><br></pre></td></tr></table></figure>

<p>整个流程大约是：将栈指针赋给%rdx， 将<em>栈指针+0x4</em>的值（内存地址）所指向的值赋给%rcx,将<em>栈指针+0x14</em>的值（内存地址）所指向的值赋给%rax，%rax是返回值。随后，将%rax的值（内存地址）赋值给*%rsp+0x8<em>（内存地址）所指向的值。随后，将</em>栈指针+0x10<em>的值所指向的值赋给%rax。随后，将%rax的值赋给%rsp。……有点长，接下去的也是类似的操作。<br>不过，经过整理后，可以看出，这些代码把各个寄存器的值所指向的地址设置为</em>栈指针* + 0，4，8，12，16，20。此刻应该有点感觉了。在调用<code>sscanf</code>之前，看到有将立即数$0x4025c3放到%esi中。根据之前的经验，可以通过<code>x/s 0x4025c3</code>来看它所指向的值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x4025c3</span><br><span class="line">0x4025c3:       &quot;%d %d %d %d %d %d&quot;</span><br></pre></td></tr></table></figure>

<p>因此，<code>&lt;read_six_numbers&gt;</code>方法显然正如他表示的，是读取六个数字。并且根据上文的格式，可知这个数字是整数。好，接下来让我们回到phase_2()中。</p>
<p>那么我们继续看下去。接下去执行的是<code> cmpl   $0x1,(%rsp)</code>和<code>je     0x400f30 &lt;phase_2+52&gt;</code>。显然，判断%rsp即栈指针内存指向的值是否为1，如果是，则跳转到+52行，不是，则炸弹爆炸。回想到<code>&lt;read_six_numbers&gt;</code>将读取到的数字分别存到栈指针+0、+4、+8、+12、+16、+20上去。因此，这段汇编代码告诉我们，输入的那六个数字中，第一个必须是0x1，即1<sub>d</sub>。</p>
<p>接下去是<code>lea    0x4(%rsp),%rbx</code>和<code>lea    0x18(%rsp),%rbp</code>。将栈指针下移0x4的内存地址赋给%rbx，将栈指针下移0x18的内存地址赋给%rbp。然后，代码又跳回去。执行<code>mov    -0x4(%rbx),%eax</code>、<code>add    %eax,%eax</code>、<code>cmp    %eax,(%rbx)</code>。即将栈指针指向的值赋给%eax，随后将%eax的值 * 2，比较%eax和%rbx的值。根据上文<code>lea    0x4(%rsp),%rbx</code>可知，%rbx存的是第二个数字。因此，这段代码就是将第一个数字和第二个数字进行比较，判断第二个数字是否为第一个数字的两倍。如果相等，则跳转执行 <code>add    $0x4,%rbx</code>，<code>cmp    %rbp,%rbx</code>，将%rbx继续下移0x4，随后与%rbx比较。根据之前的代码可知，%rbx存的是最后一个数字的地址。所以，如果不相等，继续下移，相等，则意味着遍历结束，函数结束。</p>
<p>至此，整个phase_2()的代码逻辑已经十分了然了。我们甚至可以用C写出类似逻辑的代码来：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[<span class="number">6</span>];</span><br><span class="line"><span class="built_in">read_six_numbers</span>(a);				<span class="comment">//得到六个数字.</span></span><br><span class="line"><span class="keyword">if</span>(a[<span class="number">0</span>] != <span class="number">1</span>) <span class="built_in">explode_bomb</span>();		<span class="comment">//不为1，炸弹爆炸。</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span>;i&lt;<span class="number">6</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i] != <span class="number">2</span>*a[i<span class="number">-1</span>]) </span><br><span class="line">			<span class="built_in">explode_bomb</span>();			<span class="comment">//后数不为两倍，炸弹爆炸。</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>于是，我们可以得到数字序列：1 2 4 8 16 32。运行bomb。得到:</p>
<img src="http://satt.oss-cn-hangzhou.aliyuncs.com/img/phase_2success.png" alt="phase_2success" style="zoom:67%;" />

<p>*hooray again!*接下去是第三个.</p>
<h3 id="phase-3"><a href="#phase-3" class="headerlink" title="phase_3()"></a>phase_3()</h3><p>执行<code>disas phase_3</code>得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400f43 &lt;+0&gt;:     sub    $0x18,%rsp</span><br><span class="line">0x0000000000400f47 &lt;+4&gt;:     lea    0xc(%rsp),%rcx</span><br><span class="line">0x0000000000400f4c &lt;+9&gt;:     lea    0x8(%rsp),%rdx</span><br><span class="line">0x0000000000400f51 &lt;+14&gt;:    mov    $0x4025cf,%esi</span><br><span class="line">0x0000000000400f56 &lt;+19&gt;:    mov    $0x0,%eax</span><br><span class="line">0x0000000000400f5b &lt;+24&gt;:    call   0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x0000000000400f60 &lt;+29&gt;:    cmp    $0x1,%eax</span><br><span class="line">0x0000000000400f63 &lt;+32&gt;:    jg     0x400f6a &lt;phase_3+39&gt;</span><br><span class="line">0x0000000000400f65 &lt;+34&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400f6a &lt;+39&gt;:    cmpl   $0x7,0x8(%rsp)</span><br><span class="line">0x0000000000400f6f &lt;+44&gt;:    ja     0x400fad &lt;phase_3+106&gt;</span><br><span class="line">0x0000000000400f71 &lt;+46&gt;:    mov    0x8(%rsp),%eax</span><br><span class="line">0x0000000000400f75 &lt;+50&gt;:    jmp    *0x402470(,%rax,8)</span><br><span class="line">0x0000000000400f7c &lt;+57&gt;:    mov    $0xcf,%eax</span><br><span class="line">0x0000000000400f81 &lt;+62&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f83 &lt;+64&gt;:    mov    $0x2c3,%eax</span><br><span class="line">0x0000000000400f88 &lt;+69&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f8a &lt;+71&gt;:    mov    $0x100,%eax</span><br><span class="line">0x0000000000400f8f &lt;+76&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f91 &lt;+78&gt;:    mov    $0x185,%eax</span><br><span class="line">0x0000000000400f96 &lt;+83&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f98 &lt;+85&gt;:    mov    $0xce,%eax</span><br><span class="line">0x0000000000400f9d &lt;+90&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f9f &lt;+92&gt;:    mov    $0x2aa,%eax</span><br><span class="line">0x0000000000400fa4 &lt;+97&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400fa6 &lt;+99&gt;:    mov    $0x147,%eax</span><br><span class="line">0x0000000000400fab &lt;+104&gt;:   jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400fad &lt;+106&gt;:   call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400fb2 &lt;+111&gt;:   mov    $0x0,%eax</span><br><span class="line">0x0000000000400fb7 &lt;+116&gt;:   jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400fb9 &lt;+118&gt;:   mov    $0x137,%eax</span><br><span class="line">0x0000000000400fbe &lt;+123&gt;:   cmp    0xc(%rsp),%eax</span><br><span class="line">0x0000000000400fc2 &lt;+127&gt;:   je     0x400fc9 &lt;phase_3+134&gt;</span><br><span class="line">0x0000000000400fc4 &lt;+129&gt;:   call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000400fc9 &lt;+134&gt;:   add    $0x18,%rsp</span><br><span class="line">0x0000000000400fcd &lt;+138&gt;:   ret</span><br></pre></td></tr></table></figure>

<p>随着实验进程的推进，我们的经验越来越丰富了，当然，问题的难度应该也逐渐递增。从汇编代码的长度也可以看出来这一点。老样子，先分析一波汇编代码。</p>
<p>首先将%rcx赋值为%rsp+0xc的内存地址、%rdx赋值为%rsp+0x8的内存地址。随后，将立即数0x4025cf赋值给%esi。随后执行输入方法。显然老样子，输入<code>x/s 0x4025cf</code>看看格式。<br><code>0x4025cf:       &quot;%d %d&quot;</code>.看来这次的输入是两个整数。<code>cmp    $0x1,%eax</code>的目的是判断输入是否成功，失败则炸弹爆炸。而<code>cmpl   $0x7,0x8(%rsp)</code>则是判断原%rdx指向的内存地址是否大于7.观察后续代码可知，如果大于，则炸弹爆炸。<em>看来第一个数字应该小于7</em>。随后的代码<code>mov    0x8(%rsp),%eax</code>则是给%eax赋值（输入的第一个数字）。以上逻辑可以用这张图片来表示：</p>
<img src="http://satt.oss-cn-hangzhou.aliyuncs.com/img/phase_3的前半部分.png" alt="phase_3的前半部分" style="zoom:80%;" />

<p>接下去看到了奇怪的代码：<code>jmp    *0x402470(,%rax,8)</code>。于是，让我们来手动算算。假设我输入的第一个数字是0，那么%rax的值也是0.接下去就只需要看看*0x402470的值是什么.</p>
<details ><summary>后记</summary><div class="fold-content"><p>其实后来继续看书，发现这句话实际上就是很典型的switch()语句，后面的也是典型的跳转表结构，当时没有认出来。</p>
</div></details>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print *(0x402470)</span><br><span class="line">$1 = 4198268</span><br></pre></td></tr></table></figure>

<p>可以看到是一个奇怪的数字。我到这里就卡住了。后来看了别人的解释，才发现原来需要转换成十六进制。于是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) print/x *(0x402470)</span><br><span class="line">$4 = 0x400f7c</span><br></pre></td></tr></table></figure>

<p>这个数字就比较眼熟了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400f81 &lt;+62&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;</span><br><span class="line">0x0000000000400f7c &lt;+57&gt;:    mov    $0xcf,%eax</span><br></pre></td></tr></table></figure>

<p>原来如此，合理推断，剩下的汇编代码中，几个类似结构就是对应不同的输入跳转到不同的代码。目前已知，当x1=0时，x2应该是0xcf，即207<sub>d</sub>。剩下的只是类似的操作而已，不赘。</p>
<p>测试一波。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ ./bomb</span><br><span class="line">Welcome to my fiendish little bomb. You have 6 phases with</span><br><span class="line"><span class="built_in">which</span> to blow yourself up. Have a nice day!</span><br><span class="line">Border relations with Canada have never been better.</span><br><span class="line">Phase 1 defused. How about the next one?</span><br><span class="line">1 2 4 8 16 32</span><br><span class="line">That<span class="string">&#x27;s number 2.  Keep going!</span></span><br><span class="line"><span class="string">0 207</span></span><br><span class="line"><span class="string">Halfway there!</span></span><br></pre></td></tr></table></figure>

<p>phase_3()完成，对我来说，比前两个要容易不少。接下去是phase_4。</p>
<h3 id="phase-4"><a href="#phase-4" class="headerlink" title="phase_4()"></a>phase_4()</h3><p>仍然是老三套，得到phase_4()的反汇编代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0x000000000040100c &lt;+0&gt;:     sub    $0x18,%rsp</span><br><span class="line">0x0000000000401010 &lt;+4&gt;:     lea    0xc(%rsp),%rcx</span><br><span class="line">0x0000000000401015 &lt;+9&gt;:     lea    0x8(%rsp),%rdx</span><br><span class="line">0x000000000040101a &lt;+14&gt;:    mov    $0x4025cf,%esi</span><br><span class="line">0x000000000040101f &lt;+19&gt;:    mov    $0x0,%eax</span><br><span class="line">0x0000000000401024 &lt;+24&gt;:    call   0x400bf0 &lt;__isoc99_sscanf@plt&gt;</span><br><span class="line">0x0000000000401029 &lt;+29&gt;:    cmp    $0x2,%eax</span><br><span class="line">0x000000000040102c &lt;+32&gt;:    jne    0x401035 &lt;phase_4+41&gt;</span><br><span class="line">0x000000000040102e &lt;+34&gt;:    cmpl   $0xe,0x8(%rsp)</span><br><span class="line">0x0000000000401033 &lt;+39&gt;:    jbe    0x40103a &lt;phase_4+46&gt;</span><br><span class="line">0x0000000000401035 &lt;+41&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x000000000040103a &lt;+46&gt;:    mov    $0xe,%edx</span><br><span class="line">0x000000000040103f &lt;+51&gt;:    mov    $0x0,%esi</span><br><span class="line">0x0000000000401044 &lt;+56&gt;:    mov    0x8(%rsp),%edi</span><br><span class="line">0x0000000000401048 &lt;+60&gt;:    call   0x400fce &lt;func4&gt;</span><br><span class="line">0x000000000040104d &lt;+65&gt;:    test   %eax,%eax</span><br><span class="line">0x000000000040104f &lt;+67&gt;:    jne    0x401058 &lt;phase_4+76&gt;</span><br><span class="line">0x0000000000401051 &lt;+69&gt;:    cmpl   $0x0,0xc(%rsp)</span><br><span class="line">0x0000000000401056 &lt;+74&gt;:    je     0x40105d &lt;phase_4+81&gt;</span><br><span class="line">0x0000000000401058 &lt;+76&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x000000000040105d &lt;+81&gt;:    add    $0x18,%rsp</span><br><span class="line">0x0000000000401061 &lt;+85&gt;:    ret</span><br></pre></td></tr></table></figure>

<p>将%rcx指向%rsp即栈指针的+0xc位置，%rdx指向%rsp+0x8。随后将立即数0x4025cf赋值给%esi。依旧是老套路了。看到0x4025cf的值是<code>%d %d</code>。这次又是输入两个整数,和phase_3几乎一模一样。</p>
<p><code>cmpl   $0xe,0x8(%rsp)</code> 将0xe与第一个数字进行比较。若第一个数字&gt;0xe，则炸弹爆炸。否则，则跳转执行<code>mov    $0xe,%edx</code>将0xe赋值给%edx.<code>$0x0,%esi</code> 将0赋值给%esi。<code>mov    0x8(%rsp),%edi</code>将第一个输入的数赋值给%edi。根据寄存器的设定，可知前三个参数被设置为：第一个输入的数、0x0、0xe。随后，执行<code>func4()</code>。让我们看看。得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000400fce &lt;+0&gt;:     sub    $0x8,%rsp</span><br><span class="line">0x0000000000400fd2 &lt;+4&gt;:     mov    %edx,%eax</span><br><span class="line">0x0000000000400fd4 &lt;+6&gt;:     sub    %esi,%eax</span><br><span class="line">0x0000000000400fd6 &lt;+8&gt;:     mov    %eax,%ecx</span><br><span class="line">0x0000000000400fd8 &lt;+10&gt;:    shr    $0x1f,%ecx</span><br><span class="line">0x0000000000400fdb &lt;+13&gt;:    add    %ecx,%eax</span><br><span class="line">0x0000000000400fdd &lt;+15&gt;:    sar    %eax</span><br><span class="line">0x0000000000400fdf &lt;+17&gt;:    lea    (%rax,%rsi,1),%ecx</span><br><span class="line">0x0000000000400fe2 &lt;+20&gt;:    cmp    %edi,%ecx</span><br><span class="line">0x0000000000400fe4 &lt;+22&gt;:    jle    0x400ff2 &lt;func4+36&gt;</span><br><span class="line">0x0000000000400fe6 &lt;+24&gt;:    lea    -0x1(%rcx),%edx</span><br><span class="line">0x0000000000400fe9 &lt;+27&gt;:    call   0x400fce &lt;func4&gt;</span><br><span class="line">0x0000000000400fee &lt;+32&gt;:    add    %eax,%eax</span><br><span class="line">0x0000000000400ff0 &lt;+34&gt;:    jmp    0x401007 &lt;func4+57&gt;</span><br><span class="line">0x0000000000400ff2 &lt;+36&gt;:    mov    $0x0,%eax</span><br><span class="line">0x0000000000400ff7 &lt;+41&gt;:    cmp    %edi,%ecx</span><br><span class="line">0x0000000000400ff9 &lt;+43&gt;:    jge    0x401007 &lt;func4+57&gt;</span><br><span class="line">0x0000000000400ffb &lt;+45&gt;:    lea    0x1(%rcx),%esi</span><br><span class="line">0x0000000000400ffe &lt;+48&gt;:    call   0x400fce &lt;func4&gt;</span><br><span class="line">0x0000000000401003 &lt;+53&gt;:    lea    0x1(%rax,%rax,1),%eax</span><br><span class="line">0x0000000000401007 &lt;+57&gt;:    add    $0x8,%rsp</span><br><span class="line">0x000000000040100b &lt;+61&gt;:    ret</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个函数就不细说了，大致逻辑是。用第三个参数减去第二个参数，将结果存到%ecx中，将其算数右移0x1f，即右移31<sub>d</sub> ，再把右移的结果%eax中。随后再对%eax进行逻辑右移。这样得到的似乎是最大的整数。然后，将加上%rsi（值为0x0），设为%ecx的值。再比较%edi和%ecx，也就是第一个输入的值和最大整数进行比较。如果小于等于，则跳转执行，将%eax设为0.比较edi输入的值。这一段把我绕晕了，看了别人的解析，原来这段逻辑可以写成下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a, c, d</span>):</span></span><br><span class="line">    b = d &lt; c ? (d+c+<span class="number">1</span>)/<span class="number">2</span> : (d+c)/<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> b &lt; a:</span><br><span class="line">        <span class="keyword">return</span> func(a, b+d, d)*<span class="number">2</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> b &gt; a:</span><br><span class="line">        <span class="keyword">return</span> func(a, c, b-<span class="number">1</span>)*<span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>看来我的汇编代码阅读能力还需要提高啊。总之，知道了<code>func4()</code>，我们就很容易解出答案了。d1 = 7，d2 =0.</p>
<h3 id="phase-5"><a href="#phase-5" class="headerlink" title="phase_5()"></a>phase_5()</h3><p>phase_5()的汇编代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">0x0000000000401062 &lt;+0&gt;:     push   %rbx</span><br><span class="line">0x0000000000401063 &lt;+1&gt;:     sub    $0x20,%rsp</span><br><span class="line">0x0000000000401067 &lt;+5&gt;:     mov    %rdi,%rbx</span><br><span class="line">0x000000000040106a &lt;+8&gt;:     mov    %fs:0x28,%rax</span><br><span class="line">0x0000000000401073 &lt;+17&gt;:    mov    %rax,0x18(%rsp)</span><br><span class="line">0x0000000000401078 &lt;+22&gt;:    xor    %eax,%eax</span><br><span class="line">0x000000000040107a &lt;+24&gt;:    call   0x40131b &lt;string_length&gt;</span><br><span class="line">0x000000000040107f &lt;+29&gt;:    cmp    $0x6,%eax</span><br><span class="line">0x0000000000401082 &lt;+32&gt;:    je     0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">0x0000000000401084 &lt;+34&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x0000000000401089 &lt;+39&gt;:    jmp    0x4010d2 &lt;phase_5+112&gt;</span><br><span class="line">0x000000000040108b &lt;+41&gt;:    movzbl (%rbx,%rax,1),%ecx</span><br><span class="line">0x000000000040108f &lt;+45&gt;:    mov    %cl,(%rsp)</span><br><span class="line">0x0000000000401092 &lt;+48&gt;:    mov    (%rsp),%rdx</span><br><span class="line">0x0000000000401096 &lt;+52&gt;:    and    $0xf,%edx</span><br><span class="line">0x0000000000401099 &lt;+55&gt;:    movzbl 0x4024b0(%rdx),%edx</span><br><span class="line">0x00000000004010a0 &lt;+62&gt;:    mov    %dl,0x10(%rsp,%rax,1)</span><br><span class="line">0x00000000004010a4 &lt;+66&gt;:    add    $0x1,%rax</span><br><span class="line">0x00000000004010a8 &lt;+70&gt;:    cmp    $0x6,%rax</span><br><span class="line">0x00000000004010ac &lt;+74&gt;:    jne    0x40108b &lt;phase_5+41&gt;</span><br><span class="line">0x00000000004010ae &lt;+76&gt;:    movb   $0x0,0x16(%rsp)</span><br><span class="line">0x00000000004010b3 &lt;+81&gt;:    mov    $0x40245e,%esi</span><br><span class="line">0x00000000004010b8 &lt;+86&gt;:    lea    0x10(%rsp),%rdi</span><br><span class="line">0x00000000004010bd &lt;+91&gt;:    call   0x401338 &lt;strings_not_equal&gt;</span><br><span class="line">0x00000000004010c2 &lt;+96&gt;:    test   %eax,%eax</span><br><span class="line">0x00000000004010c4 &lt;+98&gt;:    je     0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">0x00000000004010c6 &lt;+100&gt;:   call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">0x00000000004010cb &lt;+105&gt;:   nopl   0x0(%rax,%rax,1)</span><br><span class="line">0x00000000004010d0 &lt;+110&gt;:   jmp    0x4010d9 &lt;phase_5+119&gt;</span><br><span class="line">0x00000000004010d2 &lt;+112&gt;:   mov    $0x0,%eax</span><br><span class="line">0x00000000004010d7 &lt;+117&gt;:   jmp    0x40108b &lt;phase_5+41&gt;</span><br><span class="line">0x00000000004010d9 &lt;+119&gt;:   mov    0x18(%rsp),%rax</span><br><span class="line">0x00000000004010de &lt;+124&gt;:   xor    %fs:0x28,%rax</span><br><span class="line">0x00000000004010e7 &lt;+133&gt;:   je     0x4010ee &lt;phase_5+140&gt;</span><br><span class="line">0x00000000004010e9 &lt;+135&gt;:   call   0x400b30 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line">0x00000000004010ee &lt;+140&gt;:   add    $0x20,%rsp</span><br><span class="line">0x00000000004010f2 &lt;+144&gt;:   pop    %rbx</span><br><span class="line">0x00000000004010f3 &lt;+145&gt;:   ret</span><br></pre></td></tr></table></figure>

<p>大致分析一波。前面大约是一系列保存操作，随后调用<code>&lt;string_length&gt;</code>，可见判断的是字符串的长度是否为0x6.然后再把返回值清零，跳回+41；可以看出，下面是一个循环。随后，将栈底指向的内存地址赋值给%ecx。随后将%cl的值赋值给栈指针%rsp；再将%cl的值所指向的值赋值给%rdx。再用0xf对%edx做与运算。</p>
<p>这里需要稍微留意一下。%edx共有32位，那么0xf可写成：0000 0000 0000 0000 0000 0000 0000 1111<sub>b</sub>。显然，这个与运算就是将%eax保存的值，除了低四位外，全部清零。随后进行的操作是将经过与运算之后的%rdx的值再加上偏移0x4024b0，复制到%edx当中。让我们先来看看0x4024b0里是什么东西。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x4024b0</span><br><span class="line">0x4024b0 &lt;array.3449&gt;:  &quot;maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?&quot;</span><br></pre></td></tr></table></figure>

<p>嗯。。。前面的几个字母<code>maduiersnfotvbyl</code>共16个，很容易联想到之前取低四位的操作。接下去，又把%dl的值赋给栈指针的后16个内存地址，再将返回值自增，随后比较返回值和6的大小，如果小于，则继续循环。可见，这个循环要进行六次，和之前输入的六个字符能够对上，很好理解。如果等于6，则将栈指针后24位内存地址赋值为0，将立即数0x40245e赋值给%esi，再将%rdi赋值位栈指针后16位的值。随后调用<code>&lt;strings_not_equal&gt;</code>方法。如果相等，则phase_5()结束。分析结束！<em>hooray!!</em></p>
<p>那么我们只需要来看看0x40245e指向的字符串是什么就可以知道答案了.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s 0x40245e</span><br><span class="line">0x40245e:       &quot;flyers&quot;</span><br></pre></td></tr></table></figure>

<p>得到<code>flyers</code>。也就是说，之前得到的<code>maduiersnfotvbyl</code>，再结合我们输入的六个字符，其低四位当作偏移，输出的结果应该依次为<code>flyers</code>。找找各自对应的位置。得到1001(9)、1111(15)、1110(14)、0101(5)、0110(6)、0111(7)，即我们输入的六个字符的低四位应该是这些。简单点，直接搜索ascii的二进制码。得到<code>)/.%Fg</code>，尝试一下，可以，剩下的是最后一个.</p>
<p><img src="http://satt.oss-cn-hangzhou.aliyuncs.com/img/QQ%E6%88%AA%E5%9B%BE20210804173456.png" alt="QQ截图20210804173456"></p>
<h3 id="phase-6"><a href="#phase-6" class="headerlink" title="phase_6()"></a>phase_6()</h3><p>phase_6()的汇编代码长得一页都放不下了。</p>
<details ><summary>phase_6()的汇编代码</summary><div class="fold-content"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">   0x00000000004010f4 &lt;+0&gt;:     push   %r14</span><br><span class="line">   0x00000000004010f6 &lt;+2&gt;:     push   %r13</span><br><span class="line">   0x00000000004010f8 &lt;+4&gt;:     push   %r12</span><br><span class="line">   0x00000000004010fa &lt;+6&gt;:     push   %rbp</span><br><span class="line">   0x00000000004010fb &lt;+7&gt;:     push   %rbx</span><br><span class="line">   0x00000000004010fc &lt;+8&gt;:     sub    $0x50,%rsp</span><br><span class="line">   0x0000000000401100 &lt;+12&gt;:    mov    %rsp,%r13</span><br><span class="line">   0x0000000000401103 &lt;+15&gt;:    mov    %rsp,%rsi</span><br><span class="line">   0x0000000000401106 &lt;+18&gt;:    call   0x40145c &lt;read_six_numbers&gt;</span><br><span class="line">   0x000000000040110b &lt;+23&gt;:    mov    %rsp,%r14</span><br><span class="line">   0x000000000040110e &lt;+26&gt;:    mov    $0x0,%r12d</span><br><span class="line">   0x0000000000401114 &lt;+32&gt;:    mov    %r13,%rbp</span><br><span class="line">   0x0000000000401117 &lt;+35&gt;:    mov    0x0(%r13),%eax</span><br><span class="line">   0x000000000040111b &lt;+39&gt;:    sub    $0x1,%eax</span><br><span class="line">   0x000000000040111e &lt;+42&gt;:    cmp    $0x5,%eax</span><br><span class="line">   0x0000000000401121 &lt;+45&gt;:    jbe    0x401128 &lt;phase_6+52&gt;</span><br><span class="line">   0x0000000000401123 &lt;+47&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000401128 &lt;+52&gt;:    add    $0x1,%r12d</span><br><span class="line">   0x000000000040112c &lt;+56&gt;:    cmp    $0x6,%r12d</span><br><span class="line">   0x0000000000401130 &lt;+60&gt;:    je     0x401153 &lt;phase_6+95&gt;</span><br><span class="line">   0x0000000000401132 &lt;+62&gt;:    mov    %r12d,%ebx</span><br><span class="line">   0x0000000000401135 &lt;+65&gt;:    movslq %ebx,%rax</span><br><span class="line">   0x0000000000401138 &lt;+68&gt;:    mov    (%rsp,%rax,4),%eax</span><br><span class="line">   0x000000000040113b &lt;+71&gt;:    cmp    %eax,0x0(%rbp)</span><br><span class="line">   0x000000000040113e &lt;+74&gt;:    jne    0x401145 &lt;phase_6+81&gt;</span><br><span class="line">   0x0000000000401140 &lt;+76&gt;:    call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x0000000000401145 &lt;+81&gt;:    add    $0x1,%ebx</span><br><span class="line">   0x0000000000401148 &lt;+84&gt;:    cmp    $0x5,%ebx</span><br><span class="line">   0x000000000040114b &lt;+87&gt;:    jle    0x401135 &lt;phase_6+65&gt;</span><br><span class="line">   0x000000000040114d &lt;+89&gt;:    add    $0x4,%r13</span><br><span class="line">   0x0000000000401151 &lt;+93&gt;:    jmp    0x401114 &lt;phase_6+32&gt;</span><br><span class="line">   0x0000000000401153 &lt;+95&gt;:    lea    0x18(%rsp),%rsi</span><br><span class="line">   0x0000000000401158 &lt;+100&gt;:   mov    %r14,%rax</span><br><span class="line">   0x000000000040115b &lt;+103&gt;:   mov    $0x7,%ecx</span><br><span class="line">   0x0000000000401160 &lt;+108&gt;:   mov    %ecx,%edx</span><br><span class="line">   0x0000000000401162 &lt;+110&gt;:   sub    (%rax),%edx</span><br><span class="line">   0x0000000000401164 &lt;+112&gt;:   mov    %edx,(%rax)</span><br><span class="line">   0x0000000000401166 &lt;+114&gt;:   add    $0x4,%rax</span><br><span class="line">   0x000000000040116a &lt;+118&gt;:   cmp    %rsi,%rax</span><br><span class="line">   0x000000000040116d &lt;+121&gt;:   jne    0x401160 &lt;phase_6+108&gt;</span><br><span class="line">   0x000000000040116f &lt;+123&gt;:   mov    $0x0,%esi</span><br><span class="line">   0x0000000000401174 &lt;+128&gt;:   jmp    0x401197 &lt;phase_6+163&gt;</span><br><span class="line">   0x0000000000401176 &lt;+130&gt;:   mov    0x8(%rdx),%rdx</span><br><span class="line">   0x000000000040117a &lt;+134&gt;:   add    $0x1,%eax</span><br><span class="line">   0x000000000040117d &lt;+137&gt;:   cmp    %ecx,%eax</span><br><span class="line">   0x000000000040117f &lt;+139&gt;:   jne    0x401176 &lt;phase_6+130&gt;</span><br><span class="line">   0x0000000000401181 &lt;+141&gt;:   jmp    0x401188 &lt;phase_6+148&gt;</span><br><span class="line">   0x0000000000401183 &lt;+143&gt;:   mov    $0x6032d0,%edx</span><br><span class="line">   0x0000000000401188 &lt;+148&gt;:   mov    %rdx,0x20(%rsp,%rsi,2)</span><br><span class="line">   0x000000000040118d &lt;+153&gt;:   add    $0x4,%rsi</span><br><span class="line">   0x0000000000401191 &lt;+157&gt;:   cmp    $0x18,%rsi</span><br><span class="line">   0x0000000000401195 &lt;+161&gt;:   je     0x4011ab &lt;phase_6+183&gt;</span><br><span class="line">   0x0000000000401197 &lt;+163&gt;:   mov    (%rsp,%rsi,1),%ecx</span><br><span class="line">--Type &lt;RET&gt; for more, q to quit, c to continue without paging--</span><br><span class="line">   0x000000000040119a &lt;+166&gt;:   cmp    $0x1,%ecx</span><br><span class="line">   0x000000000040119d &lt;+169&gt;:   jle    0x401183 &lt;phase_6+143&gt;</span><br><span class="line">   0x000000000040119f &lt;+171&gt;:   mov    $0x1,%eax</span><br><span class="line">   0x00000000004011a4 &lt;+176&gt;:   mov    $0x6032d0,%edx</span><br><span class="line">   0x00000000004011a9 &lt;+181&gt;:   jmp    0x401176 &lt;phase_6+130&gt;</span><br><span class="line">   0x00000000004011ab &lt;+183&gt;:   mov    0x20(%rsp),%rbx</span><br><span class="line">   0x00000000004011b0 &lt;+188&gt;:   lea    0x28(%rsp),%rax</span><br><span class="line">   0x00000000004011b5 &lt;+193&gt;:   lea    0x50(%rsp),%rsi</span><br><span class="line">   0x00000000004011ba &lt;+198&gt;:   mov    %rbx,%rcx</span><br><span class="line">   0x00000000004011bd &lt;+201&gt;:   mov    (%rax),%rdx</span><br><span class="line">   0x00000000004011c0 &lt;+204&gt;:   mov    %rdx,0x8(%rcx)</span><br><span class="line">   0x00000000004011c4 &lt;+208&gt;:   add    $0x8,%rax</span><br><span class="line">   0x00000000004011c8 &lt;+212&gt;:   cmp    %rsi,%rax</span><br><span class="line">   0x00000000004011cb &lt;+215&gt;:   je     0x4011d2 &lt;phase_6+222&gt;</span><br><span class="line">   0x00000000004011cd &lt;+217&gt;:   mov    %rdx,%rcx</span><br><span class="line">   0x00000000004011d0 &lt;+220&gt;:   jmp    0x4011bd &lt;phase_6+201&gt;</span><br><span class="line">   0x00000000004011d2 &lt;+222&gt;:   movq   $0x0,0x8(%rdx)</span><br><span class="line">   0x00000000004011da &lt;+230&gt;:   mov    $0x5,%ebp</span><br><span class="line">   0x00000000004011df &lt;+235&gt;:   mov    0x8(%rbx),%rax</span><br><span class="line">   0x00000000004011e3 &lt;+239&gt;:   mov    (%rax),%eax</span><br><span class="line">   0x00000000004011e5 &lt;+241&gt;:   cmp    %eax,(%rbx)</span><br><span class="line">   0x00000000004011e7 &lt;+243&gt;:   jge    0x4011ee &lt;phase_6+250&gt;</span><br><span class="line">   0x00000000004011e9 &lt;+245&gt;:   call   0x40143a &lt;explode_bomb&gt;</span><br><span class="line">   0x00000000004011ee &lt;+250&gt;:   mov    0x8(%rbx),%rbx</span><br><span class="line">   0x00000000004011f2 &lt;+254&gt;:   sub    $0x1,%ebp</span><br><span class="line">   0x00000000004011f5 &lt;+257&gt;:   jne    0x4011df &lt;phase_6+235&gt;</span><br><span class="line">   0x00000000004011f7 &lt;+259&gt;:   add    $0x50,%rsp</span><br><span class="line">   0x00000000004011fb &lt;+263&gt;:   pop    %rbx</span><br><span class="line">   0x00000000004011fc &lt;+264&gt;:   pop    %rbp</span><br><span class="line">   0x00000000004011fd &lt;+265&gt;:   pop    %r12</span><br><span class="line">   0x00000000004011ff &lt;+267&gt;:   pop    %r13</span><br><span class="line">   0x0000000000401201 &lt;+269&gt;:   pop    %r14</span><br><span class="line">   0x0000000000401203 &lt;+271&gt;:   ret</span><br></pre></td></tr></table></figure></div></details>

<p>不过分析起来依旧是老套路。首先压入了大量的寄存器，可以预见在接下来的代码中很可能会用到它们。然后又是<code>&lt;read_six_numbers&gt;</code>，读取六个数字。将返回值%eax设定为栈指针指向的内存…………本来是想继续写的，但是这个长度实在是让人绝望。我直接放弃了，看了别人的解析。</p>
<p>原来这么长一段汇编代码大约就做了如下的事情(图也是偷来的)：</p>
<p><img src="http://satt.oss-cn-hangzhou.aliyuncs.com/img/image-20210804194949734.png" alt="image-20210804194949734"></p>
<p>这段代码表示了一个链表。并且我们知道了每个链表的值，因此只需要顺序输入答案5、6、1、4、3、2即可。</p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>大体写完了，尽管phase_6()我实际上并没有花多少时间做就放弃了（实在是太长了）。总的来说，这个bomb总体的难度是不低的，虽然在做了一两个后就有感觉，实际上的观感难度并不是特别大，但是每道题都有其巧思在，也很好的用到了课上的各种知识，如果真的让我独立完成，恐怕要多花十倍的时间才行。这套实验据说还有一个隐藏关卡，开启条件是在phase_4()的答案后面加上DREVIL。不过我对汇编实在是不感兴趣，做这套实验的目的也只是检验一下我之前学习的成果（看来成果很一般），因此也不打算做了。接下去我会继续看csapp，不过速度要加快了，毕竟我再也回不到大一大二了。没必要在这样基础的课程上花太多时间。</p>

    </div>
     
    <div class="post-footer__meta"><p>updated at 2023-05-09</p></div> 
    <div class="post-meta__cats"><a href="/tags/csapp/" class="post-tags__link button"># csapp</a><a href="/tags/%E6%B1%87%E7%BC%96/" class="post-tags__link button"># 汇编</a></div> 
</article>


    <div class="nav">
        <div class="nav__prev">
            
                <a href="/2021/08/07/%E6%8E%A5%E5%8F%A3%E7%BB%A7%E6%89%BF%E5%92%8C%E5%AE%9E%E7%8E%B0%E7%BB%A7%E6%89%BF/" class="nav__link">
                    <div>
                        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M589.088 790.624L310.464 512l278.624-278.624 45.248 45.248L400.96 512l233.376 233.376z" fill="#808080"></path></svg>
                    </div>
                    <div>
                        <div class="nav__label">
                            Previous Post
                        </div>
                        <div class="nav__title">
                            接口继承和实现继承
                        </div>
                    </div>
                </a>
            
        </div>
        <div class="nav__next">
            
        </div>
    </div>





</main>

            <footer class="footer">
    


    
     
 

 
    
        
        <p class="footer-copyright">
            Copyright © 2023 <a href="/">南方真理会</a>
        </p>
    
    
    <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p>
</footer>

        </div>
         

 

 

 

 

 



 


    
 


    
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.4.1/dist/jquery.fancybox.min.css">

    
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.4.1/dist/jquery.fancybox.min.js"></script>

    <script>
        let lazyloadT = Boolean('false'),
            auto_fancybox = Boolean('true')
        if (auto_fancybox) {
            $(".post__content").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        } else {
            $(".post__content").find("fancybox").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        }
    </script>
 

 

 

 




    </body>
</html>
